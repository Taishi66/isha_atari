import{r as i}from"./vendor-ppAWL3zK.js";class a{metrics={};observers=[];componentMetrics=new Map;constructor(){this.initializeObservers()}initializeObservers(){if(!(typeof window>"u"||!("PerformanceObserver"in window))&&(this.createObserver(["largest-contentful-paint"],t=>{const e=t[t.length-1];e&&(this.metrics.lcp=e.startTime,this.reportMetric("LCP",e.startTime))}),this.createObserver(["first-input"],t=>{const e=t[0];if(e){const r=e.processingStart-e.startTime;this.metrics.fid=r,this.reportMetric("FID",r)}}),this.createObserver(["layout-shift"],t=>{let e=0;t.forEach(r=>{const n=r;n.hadRecentInput||(e+=n.value)}),this.metrics.cls=e,this.reportMetric("CLS",e)}),this.createObserver(["paint","navigation"],t=>{t.forEach(e=>{e.name==="first-contentful-paint"&&(this.metrics.fcp=e.startTime,this.reportMetric("FCP",e.startTime))})}),"navigation"in performance)){const t=performance.getEntriesByType("navigation")[0];t&&(this.metrics.ttfb=t.responseStart-t.requestStart,this.reportMetric("TTFB",this.metrics.ttfb))}}createObserver(t,e){try{const r=new PerformanceObserver(n=>{e(n.getEntries())});r.observe({entryTypes:t}),this.observers.push(r)}catch(r){console.warn("Failed to create performance observer:",r)}}reportMetric(t,e){this.sendToAnalytics(t,e)}sendToAnalytics(t,e){if("gtag"in window){const r=window.gtag;r("event","web_vitals",{event_category:"Performance",event_label:t,value:Math.round(e),custom_map:{metric_value:e}})}navigator.sendBeacon&&navigator.sendBeacon("/api/metrics",JSON.stringify({metric:t,value:e,timestamp:Date.now(),userAgent:navigator.userAgent,url:window.location.href}))}recordComponentRender(t,e){const r=this.componentMetrics.get(t);if(r){const n=r.renderCount+1,c=(r.averageRenderTime*r.renderCount+e)/n;this.componentMetrics.set(t,{renderTime:e,renderCount:n,averageRenderTime:c,lastRenderTime:new Date})}else this.componentMetrics.set(t,{renderTime:e,renderCount:1,averageRenderTime:e,lastRenderTime:new Date})}getMetrics(){return{lcp:this.metrics.lcp||null,fid:this.metrics.fid||null,cls:this.metrics.cls||null,fcp:this.metrics.fcp||null,ttfb:this.metrics.ttfb||null}}getComponentMetrics(){return this.componentMetrics}destroy(){this.observers.forEach(t=>t.disconnect()),this.observers=[],this.componentMetrics.clear()}}const o=new a;function m(s){const t=i.useRef(performance.now());return{recordRender:i.useCallback(()=>{const r=performance.now()-t.current;o.recordComponentRender(s,r),t.current=performance.now()},[s])}}typeof window<"u"&&window.addEventListener("beforeunload",()=>{o.destroy()});export{m as u};
